
# 靈性修養問卷生成與分析系統

一個純前端的問卷編輯、生成、作答與分析系統，專為靈性修養評估設計。

## 🌟 專案特色

- **純前端實現**：無需後端，可直接部署至 GitHub Pages
- **兩頁式設計**：編輯頁面 + 作答頁面，流程清晰
- **四層分類系統**：靈性修養七面向、靈性健康十核心指標、靈修七原則、日常靈修實踐
- **版本管理**：支援題庫版本控制與快照
- **即時預覽**：編輯時可即時預覽問卷效果
- **智能分析**：自動計算各維度分數並提供建議
- **資料匯出**：支援 JSON/CSV 格式匯出
- **響應式設計**：支援手機、平板、桌機各種裝置

## 📁 專案結構

```
spiritual-survey-system/
├── index.html              # 問卷編輯頁面
├── survey.html             # 問卷作答頁面
├── assets/
│   ├── css/
│   │   └── style.css       # 主要樣式文件
│   └── js/
│       ├── utils.js        # 工具函數庫
│       ├── storage.js      # 儲存層抽象
│       ├── schema.js       # 資料模型與初始資料
│       ├── editor.js       # 編輯頁面邏輯
│       └── survey.js       # 作答頁面邏輯
└── README.md               # 專案說明文件
```

## 🚀 快速開始

### 1. 下載專案

```bash
git clone https://github.com/sun0615ni-sun/spiritual-survey-system.git
cd spiritual-survey-system
```

### 2. 本地測試

使用任一靜態伺服器啟動：

```bash
# 方法 1: 使用 Python
python -m http.server 8000

# 方法 2: 使用 Node.js
npx http-server .

# 方法 3: 使用 VSCode Live Server 擴充功能
```

### 3. 訪問系統

開啟瀏覽器訪問：
- 編輯頁面：`http://localhost:8000/index.html`
- 作答頁面：`http://localhost:8000/survey.html`

## 📖 使用手冊

### 編輯頁面功能

#### 分類管理
- **查看分類樹**：左側面板顯示四層分類結構
- **新增分類**：點擊分類旁的「+」按鈕
- **編輯分類**：點擊分類旁的「編輯」按鈕
- **刪除分類**：點擊分類旁的「刪除」按鈕
- **題目計數**：每個分類顯示包含的題目數量

#### 題目管理
- **新增題目**：點擊「新增題目」按鈕
- **編輯題目**：點擊題目旁的「編輯」按鈕
- **刪除題目**：點擊題目旁的「刪除」按鈕
- **拖曳排序**：直接拖曳題目項目重新排序
- **搜尋篩選**：使用搜尋框和篩選器快速找到題目
- **多分類標記**：一個題目可屬於多個分類
- **宗教性標記**：可標記題目是否具宗教性質

#### 預覽功能
- **即時預覽**：右側面板即時顯示問卷預覽
- **排序模式**：可切換「按分類順序」或「隨機化預覽」
- **6分量表**：預覽顯示完整的6分量表選項
- **不可作答**：預覽模式下無法實際作答

#### 版本管理
- **儲存版本**：將當前題庫儲存為新版本
- **載入版本**：載入之前儲存的版本
- **版本列表**：查看所有已儲存的版本
- **版本資訊**：顯示版本建立時間和摘要

#### 資料管理
- **匯出題庫**：將分類和題目匯出為 JSON 文件
- **匯入題庫**：從 JSON 文件匯入分類和題目
- **匯出回覆**：將收集到的回覆匯出為 CSV/JSON
- **清空資料**：重置所有資料（需確認）

### 作答頁面功能

#### 問卷作答
- **引導語**：頁面頂部顯示固定的引導說明
- **題目呈現**：依據版本設定顯示題目（不顯示分類資訊）
- **6分量表**：每題提供1-6分的選項
- **進度提示**：顯示作答進度

#### 個人資料
- **基本資料表單**：包含11個必填欄位
  - 姓名、生日、性別、國籍、城市
  - 職業、教育程度、婚姻狀況
  - 宗教信仰、居住狀況、檢測日期
- **表單驗證**：確保所有必填欄位完整填寫

#### 結果分析
- **即時分析**：提交後立即顯示分析結果
- **三組聚合**：
  - 靈性修養七面向平均分
  - 靈性健康十核心指標平均分
  - 靈修七原則平均分
- **視覺化圖表**：使用 Canvas 繪製雷達圖和長條圖
- **分數解讀**：根據分數範圍提供建議
- **結果匯出**：可下載分析結果為 JSON/CSV

## 🔧 技術規格

### 前端技術
- **HTML5**：語義化標記
- **CSS3**：Flexbox/Grid 佈局，響應式設計
- **JavaScript ES6+**：模組化程式設計
- **Canvas API**：圖表繪製
- **LocalStorage**：本地資料儲存

### 資料結構

#### 分類 (Category)
```javascript
{
  id: string,           // 唯一識別碼
  layer: LayerType,     // 分類層級
  name: string,         // 分類名稱
  parentId?: string,    // 父分類ID
  order: number         // 排序順序
}
```

#### 題目 (Question)
```javascript
{
  id: string,           // 唯一識別碼
  text: string,         // 題目內容
  categoryIds: string[], // 所屬分類ID陣列
  isReligious?: boolean, // 是否為宗教性題目
  order: number         // 排序順序
}
```

#### 版本 (Version)
```javascript
{
  id: string,           // 版本ID
  name: string,         // 版本名稱
  createdAt: string,    // 建立時間
  settings: {           // 版本設定
    orderMode: string,  // 排序模式
    includeReligious: string
  },
  snapshot: {           // 版本快照
    categories: Category[],
    questions: Question[]
  }
}
```

#### 回覆 (Response)
```javascript
{
  id: string,           // 回覆ID
  versionId: string,    // 對應版本ID
  answers: Answer[],    // 答案陣列
  demographics: Demographics, // 個人資料
  createdAt: string,    // 作答時間
  aggregates: {         // 聚合分數
    byDimension: object,
    overall: number
  }
}
```

### 儲存機制
- **LocalStorage 鍵名**：
  - `sss.categories`：分類資料
  - `sss.questions`：題目資料
  - `sss.versions`：版本資料
  - `sss.responses`：回覆資料
  - `sss.settings`：系統設定

## 🎯 四層分類系統

### 第一層：靈性修養七面向
1. 起心動念
2. 後設思考
3. 意義追尋
4. 人際靈修
5. 物質與環境
6. 與超越者的連結
7. 生活形態與全人健康

### 第二層：靈性健康十核心指標
1. 人格統整
2. 追求真理的後設反思
3. 意義與目的
4. 愛與同理
5. 寬恕與和解
6. 感恩與喜樂
7. 財物倫理與靈修
8. 惜物與共生
9. 信仰與連結（宗教性）
10. 宗教信仰與靈性修養（宗教性）

### 第三層：靈修七原則
1. 在每一個人身上看見神、看見佛、看見人
2. 第一個去愛、第一個去給
3. 給人信心、給人希望、給人歡喜、給人方便
4. 緩於發怒、敏於寬恕、勇於道歉、時時感恩
5. 連結神聖、追求意義、擇善固執、不變隨緣
6. 役物不役於物，惜物厚生濟世
7. 誠意正心、戒慎恐懼、後設反思、開放公正

### 第四層：日常靈修實踐
- 可自由新增/編輯/刪除的實踐項目
- 支援樹狀結構的子分類

## 📊 計分與分析

### 計分邏輯
1. **收集答案**：每題1-6分
2. **分類聚合**：按分類計算平均分
3. **維度分析**：
   - 七面向平均分
   - 十指標平均分
   - 七原則平均分
4. **整體評估**：計算總體平均分

### 分數解讀
- **4.5分以上**：表現優良
- **3.0-4.5分**：具備基礎，可進一步提升
- **3.0分以下**：建議加強關注

### 建議生成
根據各維度分數自動生成個人化建議，包含：
- 優勢維度的維持建議
- 待改善維度的具體行動方案
- 整體靈性發展方向

## 🚀 部署指南

### GitHub Pages 部署

1. **建立 Repository**
```bash
git init
git add .
git commit -m "Initial commit"
git remote add origin https://github.com/sun0615ni-sun/spiritual-survey-system.git
git push -u origin main
```

2. **啟用 GitHub Pages**
- 進入 Repository 設定
- 找到 "Pages" 選項
- Source 選擇 "Deploy from a branch"
- Branch 選擇 "main"
- Folder 選擇 "/ (root)"

3. **訪問網站**
- 網址：`https://sun0615ni-sun.github.io/spiritual-survey-system/`

### 其他部署選項

#### Netlify
1. 將專案資料夾拖曳到 Netlify 部署頁面
2. 自動部署完成

#### Vercel
1. 連接 GitHub Repository
2. 自動偵測並部署

#### 自架伺服器
1. 將檔案上傳到網頁伺服器
2. 確保支援靜態檔案服務

## 🔧 開發指南

### 本地開發環境

1. **安裝依賴**
```bash
# 無需安裝任何依賴，純前端專案
```

2. **啟動開發伺服器**
```bash
# 使用 Python
python -m http.server 8000

# 使用 Node.js
npx http-server . -p 8000

# 使用 PHP
php -S localhost:8000
```

3. **開發工具**
- 瀏覽器開發者工具
- VSCode + Live Server 擴充功能
- Chrome DevTools

### 程式碼結構

#### 模組化設計
- **utils.js**：通用工具函數
- **storage.js**：資料儲存抽象層
- **schema.js**：資料模型定義
- **editor.js**：編輯頁面邏輯
- **survey.js**：作答頁面邏輯

#### 事件處理
- 使用 `addEventListener` 綁定事件
- 支援鍵盤操作和無障礙功能
- 防抖和節流優化使用者體驗

#### 資料流
1. **初始化**：載入預設資料和使用者資料
2. **編輯**：即時更新預覽和儲存變更
3. **生成**：建立版本快照
4. **作答**：收集答案和個人資料
5. **分析**：計算分數和生成建議

### 自訂擴展

#### 新增分類層級
1. 修改 `schema.js` 中的 `LayerType`
2. 更新初始分類資料
3. 調整 UI 顯示邏輯

#### 新增題目類型
1. 擴展 `Question` 資料結構
2. 更新驗證邏輯
3. 修改編輯和預覽介面

#### 自訂計分邏輯
1. 修改 `survey.js` 中的計分函數
2. 調整分析結果顯示
3. 更新建議生成邏輯

## 🐛 故障排除

### 常見問題

#### 1. 按鈕無法點擊
**原因**：JavaScript 載入失敗或事件綁定錯誤
**解決方案**：
- 檢查瀏覽器控制台錯誤訊息
- 確認所有 JS 檔案路徑正確
- 檢查 DOM 元素 ID 是否正確

#### 2. 資料無法儲存
**原因**：LocalStorage 不可用或容量不足
**解決方案**：
- 檢查瀏覽器是否支援 LocalStorage
- 清理瀏覽器儲存空間
- 檢查隱私模式設定

#### 3. 頁面樣式錯亂
**原因**：CSS 檔案載入失敗
**解決方案**：
- 檢查 CSS 檔案路徑
- 確認網路連線正常
- 清除瀏覽器快取

#### 4. 圖表無法顯示
**原因**：Canvas API 不支援或資料格式錯誤
**解決方案**：
- 檢查瀏覽器 Canvas 支援
- 驗證圖表資料格式
- 檢查控制台錯誤訊息

### 除錯技巧

1. **使用瀏覽器開發者工具**
   - Console：查看錯誤訊息和除錯資訊
   - Network：檢查資源載入狀況
   - Application：查看 LocalStorage 資料

2. **啟用詳細日誌**
   - 在 `utils.js` 中設定 `DEBUG = true`
   - 查看詳細的操作日誌

3. **資料備份與恢復**
   - 定期匯出資料備份
   - 使用匯入功能恢復資料

## 📝 更新日誌

### v1.0.0 (2024-12-15)
- ✨ 初始版本發布
- ✅ 完整的問卷編輯功能
- ✅ 四層分類系統
- ✅ 版本管理機制
- ✅ 問卷作答與分析
- ✅ 資料匯入匯出
- ✅ 響應式設計
- ✅ GitHub Pages 部署支援



